- id: front_lights_on_at_night
  alias: Turn front exterior lights on at night
  trigger:
  - platform: sun
    event: sunset
    offset: -01:00:00
  action:
  - service: light.turn_on
    entity_id: light.light_front_entry_exterior

- id: front_lights_off_late
  alias: Turn front exterior lights off late at night
  trigger:
  - platform: time
    at: '01:00:00'
  action:
  - service: light.turn_off
    entity_id: light.light_front_entry_exterior


- id: entry_lights_on_after_unlock_day
  alias: Turn entry lights on when unlocked day
  trigger:
    - platform: state
      entity_id: lock.lock_front_entry
      to: unlocked
  condition:
    condition: and
    conditions:
    - condition: sun
      before: sunset
    - condition: sun
      after: sunrise
    - condition: numeric_state
      entity_id: light.front_hallway_main_lights
      value_template: '{% if states.light.front_hallway_main_lights.state == "on"  %}{{ states.light.front_hallway_main_lights.attributes.brightness }}{% else %}0{% endif %}'
      below: 150
  action:
  - service: light.turn_on
    entity_id: light.front_hallway_main_lights
    data:
      brightness: 255


- id: entry_lights_on_after_unlock_night
  alias: Turn entry lights on when unlocked night
  trigger:
  - platform: state
    entity_id: lock.lock_front_entry
    to: unlocked
  condition:
    condition: and
    conditions:
    - condition: numeric_state
      entity_id: light.front_hallway_main_lights
      value_template: '{% if states.light.front_hallway_main_lights.state == "on"  %}{{ states.light.front_hallway_main_lights.attributes.brightness }}{% else %}0{% endif %}'
      below: 80
    - condition: or
      conditions:
      - condition: sun
        after: sunset
      - condition: sun
        before: sunrise
  action:
  - service: light.turn_on
    entity_id: light.front_hallway_main_lights
    data:
      brightness: 100


- id: turn_on_all_backyard_sconces_with_house_sconces
  alias: Turn on all backyard sconces with house sconces
  trigger:
    - platform: state
      entity_id: light.exterior_sconces
      to: "on"
  action:
  - service: light.turn_on
    entity_id: 
    - light.light_studio_exterior
    - light.light_garage_exterior

- id: turn_off_all_backyard_sconces_with_house_sconces
  alias: Turn off all backyard sconces with house sconces
  trigger:
  - platform: state
    entity_id: light.exterior_sconces
    to: "off"
  action:
  - service: light.turn_off
    entity_id: 
    - light.light_studio_exterior
    - light.light_garage_exterior


- id: entry_hallway_lights_with_motion_day
  alias: Turn on entry hallway lights when the motion is detected during day
  trigger:
  - platform: state
    entity_id: binary_sensor.entry_hallway_motion
    to: 'on'
  condition:
    condition: time
    after: '07:30'
    before: '23:30'
  action:
  - service: homeassistant.turn_on
    entity_id: light.entry_hallway_sconce
    data:
      brightness: 150
  - service: homeassistant.turn_on
    entity_id: light.front_hallway_main_lights

- id: entry_hallway_lights_with_motion_night
  alias: Turn on entry hallway lights when the motion is detected at night
  trigger:
  - platform: state
    entity_id: binary_sensor.entry_hallway_motion
    to: 'on'
  condition:
    condition: or
    conditions:
    - condition: time
      after: '22:00'
    - condition: time
      before: '06:00'
  action:
  - service: homeassistant.turn_on
    data:
      entity_id:
        - light.entry_hallway_sconce
        - light.front_hallway_main_lights
      brightness: 30

- id: entry_hallway_lights_with_motion
  alias: Turn off entry hallway lights 5 minutes after no motion
  trigger:
    platform: state
    entity_id: binary_sensor.entry_hallway_motion
    to: 'off'
    for:
      minutes: 5
  action:
    service: homeassistant.turn_off
    data:
      entity_id:
        - light.entry_hallway_sconce
        - light.front_hallway_main_lights
      transition: 160

- id: utility_room_lights_with_motion_day
  alias: Turn on utility room lights when motion is detected during day
  trigger:
  - platform: state
    entity_id: binary_sensor.utility_room_motion
    to: 'on'
  condition:
    condition: time
    after: '07:30'
    before: '23:30'
  action:
  - service: homeassistant.turn_on
    data:
      entity_id:
        - light.hue_white_lamp_1
        - light.hue_color_downlight_2
    data:
      brightness: 150

- id: utility_room_lights_with_motion_night
  alias: Turn on utility room lights when motion is detected at night
  trigger:
  - platform: state
    entity_id: binary_sensor.utility_room_motion
    to: 'on'
  condition:
    condition: or
    conditions:
    - condition: time
      after: '22:00'
    - condition: time
      before: '06:00'
  action:
  - service: homeassistant.turn_on
    data:
      entity_id:
        - light.hue_white_lamp_1
        - light.hue_color_downlight_2
      brightness: 30

- id: utility_room_lights_with_motion
  alias: Turn off utility room lights 2 minutes after no motion
  trigger:
    platform: state
    entity_id: binary_sensor.utility_room_motion
    to: 'off'
    for:
      minutes: 2
  action:
    service: homeassistant.turn_off
    data:
      entity_id:
        - light.hue_white_lamp_1
        - light.hue_color_downlight_2
      transition: 20
